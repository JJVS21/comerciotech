<!DOCTYPE html>
<html lang="es">
<head>
    <meta charset="UTF-8">
    <title>Pedidos - ComercioTech</title>

    <!-- Fuente gamer -->
    <link href="https://fonts.googleapis.com/css2?family=Orbitron:wght@500;700&display=swap" rel="stylesheet">

    <!-- Estilo gamer -->
    <link rel="stylesheet" href="/static/style.css">

    <script>
        function confirmarEliminacion(id) {
            if (confirm("¬øEliminar este pedido?")) {
                window.location.href = "/pedidos/eliminar/" + id;
            }
        }
    </script>
</head>
<body>
<div class="container">
    <h2>üõí Agregar Pedido</h2>
    <form action="/pedidos/agregar" method="post">
        <label for="cliente_id">Cliente:</label>
        <select name="cliente_id" id="cliente_id" required>
            <option value="">-- Selecciona un cliente --</option>
            {% for c in clientes %}
            <option value="{{ c._id }}">{{ c.nombres }} {{ c.apellidos }}</option>
            {% endfor %}
        </select>

        <label for="producto_id">Producto:</label>
        <select name="producto_id" id="producto_id" required>
            <option value="">-- Selecciona un producto --</option>
            {% for p in productos %}
            <option value="{{ p._id }}">{{ p.nombre }} (${{ p.precio }})</option>
            {% endfor %}
        </select>

        <input type="number" name="cantidad" placeholder="Cantidad" min="1" required>

        <label for="metodo_pago">M√©todo de pago:</label>
        <select name="metodo_pago" id="metodo_pago" required>
            <option value="">-- Selecciona m√©todo --</option>
            <option value="Efectivo">Efectivo</option>
            <option value="Tarjeta">Tarjeta</option>
            <option value="Transferencia">Transferencia</option>
        </select>

        <button type="submit">‚úÖ Guardar Pedido</button>
    </form>

    <a href="/">‚Üê Volver al men√∫ principal</a>

    <h2>üìã Pedidos Registrados</h2>
    <ul>
        {% for ped in pedidos %}
        <li>
            Cliente: {{ ped.codigo_cliente }} <br>
            Fecha: {{ ped.fecha_pedido.strftime('%Y-%m-%d %H:%M') }} <br>
            Producto(s):
            <ul>
                {% for prod in ped.productos %}
                <li>{{ prod.codigo_producto }} ‚Äî Cantidad: {{ prod.cantidad }} ‚Äî Precio unitario: ${{ prod.precio_unitario }} ‚Äî Total: ${{ prod.total_comprado }}</li>
                {% endfor %}
            </ul>
            Monto total: ${{ ped.monto_total }} <br>
            M√©todo de pago: {{ ped.metodo_pago }} <br>
            <button onclick="confirmarEliminacion('{{ ped._id }}')">üóëÔ∏è Eliminar pedido</button>
        </li>
        {% else %}
        <li>No hay pedidos registrados.</li>
        {% endfor %}
    </ul>
</div>
</body>
</html>

